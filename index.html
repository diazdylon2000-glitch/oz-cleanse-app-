<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Oz Cleanse App</title>
  <link rel="icon" type="image/png" href="oz.png" />
  <link rel="stylesheet" href="style.css" />

  <!-- React and Chart.js with fallbacks -->
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"
    crossorigin
    onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/npm/react@18/umd/react.production.min.js'"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"
    crossorigin
    onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/npm/react-dom@18/umd/react-dom.production.min.js'"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"
    onerror="this.onerror=null;this.src='https://unpkg.com/chart.js@4.4.3/dist/chart.umd.js'"></script>

  <style>
    /* Inline essentials for splash and affirmations */
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background-color: #fff8f4;
      color: #333;
      -webkit-font-smoothing: antialiased;
    }
    #splash {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background-color: #ffe4d9;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      animation: fadeIn 0.6s ease;
    }
    #splash img {
      width: 180px;
      height: 180px;
      border-radius: 50%;
      object-fit: cover;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    }
    .speech-bubble {
      position: relative;
      background: #fff;
      border-radius: .4em;
      padding: 12px 16px;
      margin-bottom: 20px;
      font-size: 1.1em;
      max-width: 250px;
      text-align: center;
      animation: fadeIn 1.2s ease;
    }
    .speech-bubble:after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 50%;
      width: 0;
      height: 0;
      border: 12px solid transparent;
      border-top-color: #fff;
      border-bottom: 0;
      margin-left: -12px;
      margin-bottom: -12px;
    }
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    @keyframes fadeOut {
      from { opacity: 1; }
      to { opacity: 0; }
    }
    #errorBanner {
      display: none;
      position: fixed;
      top: 0;
      width: 100%;
      background: #ff4d4d;
      color: white;
      padding: 10px;
      font-size: 0.9em;
      z-index: 10000;
      text-align: center;
    }
  </style>
</head>
<body>
  <div id="errorBanner"></div>

  <!-- Splash Screen -->
  <div id="splash">
    <div class="speech-bubble" id="affirmationText">Loading...</div>
    <img src="oz.png" alt="Oz the Dog" />
  </div>

  <!-- Main App Root -->
  <div id="root" style="display:none;"></div>

  <script>
    (function(){
      try {
        var affirmations = [
          "You’ve got this, one sip at a time!",
          "Strong body, strong mind — keep going!",
          "Oz says: hydration is happiness!",
          "Your energy is blooming like spring.",
          "Cleansing today for a brighter tomorrow.",
          "Every step forward counts, no matter how small.",
          "Oz believes in your journey!",
          "Your dedication inspires paws and people alike.",
          "Each juice is fuel for the new you.",
          "You are glowing from the inside out!",
          "Oz says: stay playful, stay strong.",
          "One more glass, one more win.",
          "Every good choice stacks toward your goal.",
          "Your willpower is your superpower.",
          "Keep moving, you’re unstoppable!",
          "Hydrate like a champion today.",
          "This is your moment — own it.",
          "You’re lighter, brighter, and stronger every day.",
          "Oz is wagging his tail for you!",
          "Small habits create big change.",
          "You’re doing amazing — keep going.",
          "Fuel, flush, flourish.",
          "Strong today, stronger tomorrow.",
          "One choice at a time, you’re winning.",
          "Your body thanks you with every sip.",
          "Oz says: healthy looks good on you.",
          "Breathe deep, move freely.",
          "Progress is in motion — so are you.",
          "Cheers to your health!",
          "Your goals are in sight — keep your pace."
        ];
        // Shuffle without repeats until all shown
        var usedAffirmations = JSON.parse(localStorage.getItem("usedAffirmations") || "[]");
        var available = affirmations.filter(function(a){ return usedAffirmations.indexOf(a) === -1; });
        if(available.length === 0){ available = affirmations; usedAffirmations = []; }
        var pick = available[Math.floor(Math.random() * available.length)];
        usedAffirmations.push(pick);
        localStorage.setItem("usedAffirmations", JSON.stringify(usedAffirmations));
        document.getElementById("affirmationText").textContent = pick;
      } catch(e) {
        document.getElementById("errorBanner").style.display = 'block';
        document.getElementById("errorBanner").textContent = "Affirmation Error: " + e.message;
      }
    })();
  </script>
  <script>
    // Splash hide after short delay
    window.addEventListener('load', function(){
      setTimeout(function(){
        var splash = document.getElementById('splash');
        splash.style.animation = "fadeOut 0.6s ease forwards";
        setTimeout(function(){
          splash.style.display = 'none';
          document.getElementById('root').style.display = 'block';
        }, 600);
      }, 2200);
    });

    // Error handler
    window.onerror = function(message, source, lineno, colno, error) {
      var banner = document.getElementById('errorBanner');
      banner.textContent = "Error: " + message + " at " + lineno + ":" + colno;
      banner.style.display = 'block';
    };
  </script>

  <script>
    // Your React app code starts here
    const e = React.createElement;

    function App() {
      const [activeTab, setActiveTab] = React.useState('dashboard');

      return e('div', { className: 'app-container' },
        e('nav', { className: 'tab-nav' },
          e('button', { onClick: () => setActiveTab('dashboard') }, 'Dashboard'),
          e('button', { onClick: () => setActiveTab('groceries') }, 'Groceries'),
          e('button', { onClick: () => setActiveTab('calendar') }, 'Calendar'),
          e('button', { onClick: () => setActiveTab('recipes') }, 'Recipes'),
          e('button', { onClick: () => setActiveTab('photos') }, 'Progress Photos')
        ),
        e('main', null,
          activeTab === 'dashboard' && e(Dashboard, null),
          activeTab === 'groceries' && e(Groceries, null),
          activeTab === 'calendar' && e(Calendar, null),
          activeTab === 'recipes' && e(Recipes, null),
          activeTab === 'photos' && e(Photos, null)
        )
      );
    }

    function Dashboard() {
      return e('div', { className: 'dashboard' },
        e('h1', null, 'Daily Checklist'),
        e('ul', { className: 'checklist' },
          ['💧 Drink 120-150 oz water',
           '🍵 Tea (fast / cleanse)',
           'Coffee (fast / cleanse)',
           '🧃 Juices (cleanse)',
           '🧂 LMNT Electrolytes (Daily)',
           '🏃 Exercise',
           '🚫 Avoid processed food',
           '👣 Weight check in'
          ].map((item, idx) =>
            e('li', { key: idx },
              e('input', { type: 'checkbox', id: 'chk' + idx }),
              e('label', { htmlFor: 'chk' + idx }, item)
            )
          )
        )
      );
    }

    function Groceries() {
      return e('div', { className: 'groceries' },
        e('h1', null, 'Grocery List'),
        e('p', null, 'Grouped by day to reduce spoilage'),
        e('ul', null,
          e('li', null, 'Day 1-2: Oranges, Carrots, Kale'),
          e('li', null, 'Day 3-4: Spinach, Cucumbers, Apples'),
          e('li', null, 'Day 5-6: Ginger, Lemon, Mint')
        )
      );
    }

    function Calendar() {
      return e('div', { className: 'calendar' },
        e('h1', null, 'Cleanse Calendar'),
        e('p', null, 'View recipes and goals by day')
      );
    }

    function Recipes() {
      return e('div', { className: 'recipes' },
        e('h1', null, 'Recipes'),
        e('p', null, 'Preloaded juice & meal recipes will appear here.')
      );
    }

    function Photos() {
      return e('div', { className: 'photos' },
        e('h1', null, 'Progress Photos'),
        e('input', { type: 'file', accept: 'image/*' })
      );
    }

    ReactDOM.render(e(App), document.getElementById('root'));
  </script>
  <style>
    .tab-nav {
      display: flex;
      justify-content: space-around;
      background: #ffd6c9;
      padding: 8px;
      position: sticky;
      top: 0;
    }
    .tab-nav button {
      background: #fff;
      border: none;
      padding: 10px 14px;
      border-radius: 8px;
      font-size: 0.95em;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .tab-nav button:hover {
      background: #ffe8e0;
    }
    .dashboard, .groceries, .calendar, .recipes, .photos {
      padding: 16px;
    }
    .checklist {
      list-style: none;
      padding: 0;
    }
    .checklist li {
      margin: 10px 0;
      display: flex;
      align-items: center;
    }
    .checklist input[type="checkbox"] {
      margin-right: 10px;
      transform: scale(1.3);
    }
  </style>

</body>
</html>
